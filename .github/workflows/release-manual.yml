name: Release Manual Tasks

on:
  workflow_dispatch:
    inputs:
      version:
        description: 'Version to release (e.g., 0.2.0-beta.9)'
        required: true
        type: string
      deploy_vercel:
        description: 'Deploy to Vercel'
        required: false
        type: boolean
        default: true
      sync_docs:
        description: 'Sync docs to vultisig/docs'
        required: false
        type: boolean
        default: true
      sync_skills:
        description: 'Sync skills to vultisig/website-prod'
        required: false
        type: boolean
        default: true
      notify_discord:
        description: 'Send Discord notification'
        required: false
        type: boolean
        default: true

jobs:
  deploy-vercel:
    if: inputs.deploy_vercel
    uses: ./.github/workflows/deploy-vercel.yml
    secrets: inherit

  sync-docs:
    if: inputs.sync_docs
    uses: ./.github/workflows/sync-docs.yml
    with:
      version: ${{ inputs.version }}
    secrets: inherit

  sync-skills:
    if: inputs.sync_skills
    uses: ./.github/workflows/sync-skills.yml
    secrets: inherit

  notify:
    needs: [deploy-vercel, sync-docs, sync-skills]
    if: always() && inputs.notify_discord
    uses: ./.github/workflows/notify-discord.yml
    with:
      version: ${{ inputs.version }}
      browser_url: ${{ needs.deploy-vercel.outputs.url }}
    secrets: inherit
